<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaso | Former OS (Doc Generator)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Lora:wght@400;600&family=Inter:wght@400;500;600&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        leaso: { blue: '#1E40AF', gold: '#D4AF37', dark: '#111827', light: '#F3F4F6' }
                    },
                    fontFamily: { serif: ['"Playfair Display"', 'serif'], sans: ['"Roboto"', 'sans-serif'], doc: ['"Lora"', 'serif'] }
                }
            }
        }
    </script>
<style>
        /* --- MAIN UI LAYOUT --- */
        body { background-color: #e5e7eb; height: 100vh; overflow: hidden; }
        
        .preview-pane { 
            background: white; 
            box-shadow: 0 0 20px rgba(0,0,0,0.1); 
            width: 8.5in; 
            min-height: 11in; 
            margin: 20px auto; 
            padding: 0.75in;
            transform-origin: top center;
            font-family: 'Lora', serif;
            color: #222;
            overflow-y: auto; 
        }

        /* --- FORM ELEMENTS --- */
        .form-input { 
            width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; 
            border-radius: 6px; font-size: 0.875rem; margin-top: 4px; 
            transition: all 0.2s; 
        }
        .form-input:focus { border-color: #1E40AF; ring: 2px; outline: none; }
        .doc-nav-btn { text-align: left; padding: 12px; border-radius: 8px; transition: all 0.2s; font-size: 0.9rem; font-weight: 500; color: #4b5563; }
        .doc-nav-btn:hover { background-color: #f3f4f6; color: #1E40AF; }
        .doc-nav-btn.active { background-color: #eff6ff; color: #1E40AF; border-left: 4px solid #D4AF37; }

        /* --- VENDOR AGREEMENT STYLES --- */
        :root { --vendor-primary: #0F172A; --vendor-accent: #3B82F6; --legal-bg: #F8FAFC; }
        .v-header { text-align: center; border-bottom: 3px double var(--vendor-primary); padding-bottom: 25px; margin-bottom: 35px; }
        .v-logo-container { display: flex; justify-content: space-between; align-items: center; padding: 0 1rem; margin-bottom: 20px; }
        .v-logo-box { width: 200px; height: 90px; display: flex; align-items: center; justify-content: center; }
        .v-logo-box img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .v-h1 { font-family: 'Playfair Display', serif; color: var(--vendor-primary); font-size: 22pt; margin: 10px 0 5px 0; text-transform: uppercase; letter-spacing: 1.5px; }
        .v-jurisdiction { font-family: 'Inter', sans-serif; font-size: 8pt; color: var(--vendor-accent); text-transform: uppercase; letter-spacing: 3px; font-weight: 600; }
        .v-h2 { font-family: 'Playfair Display', serif; color: var(--vendor-primary); font-size: 16pt; border-bottom: 1px solid #cbd5e1; padding-bottom: 5px; margin-top: 2rem; margin-bottom: 1rem; font-weight: 700; }
        .v-h3 { font-family: 'Inter', sans-serif; font-size: 11pt; font-weight: 600; color: #475569; margin-top: 1.5rem; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .placeholder-data { background-color: #f1f5f9; padding: 2px 6px; border-radius: 4px; font-family: 'Inter', sans-serif; font-weight: 600; color: var(--vendor-primary); border: 1px dashed #94a3b8; }
        .custom-section-box { border: 1px solid #cbd5e1; background-color: #fff; padding: 1.5rem; margin: 1rem 0; border-left: 4px solid var(--vendor-accent); }
        .compliance-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 1rem 0; background: var(--legal-bg); padding: 1rem; border: 1px solid #e2e8f0; }
        .compliance-item strong { display: block; font-family: 'Inter', sans-serif; font-size: 8pt; color: #64748b; text-transform: uppercase; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-family: 'Inter', sans-serif; font-size: 9pt; }
        .input-label { display: block; color: #64748b; font-size: 8pt; text-transform: uppercase; margin-bottom: 4px; }
        .input-field { width: 100%; border-bottom: 1px solid #94a3b8; padding: 4px 0; color: var(--vendor-primary); font-weight: 600; }
        .signature-section { margin-top: 3rem; display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; break-inside: avoid; }
        .sig-line { border-bottom: 1px solid var(--vendor-primary); margin-top: 3rem; margin-bottom: 0.5rem; }
        .legal-footer { margin-top: 4rem; font-size: 8pt; text-align: center; color: #94a3b8; font-family: 'Inter', sans-serif; }

        /* --- STANDARD DOC STYLES --- */
        .doc-header { border-bottom: 2px solid #D4AF37; padding-bottom: 10px; margin-bottom: 20px; }
        .doc-title { font-family: 'Playfair Display', serif; font-size: 22pt; color: #1E40AF; font-weight: 700; margin-bottom: 5px; text-transform: uppercase; }
        .doc-subtitle { font-family: 'Roboto', sans-serif; font-size: 10pt; color: #666; text-transform: uppercase; letter-spacing: 2px; }
        .doc-h2 { font-family: 'Playfair Display', serif; color: #1E40AF; font-size: 14pt; border-bottom: 1px solid #ddd; padding-bottom: 5px; margin-top: 25px; margin-bottom: 10px; font-weight: 700; }
        .doc-p { margin-bottom: 10px; line-height: 1.5; font-size: 10.5pt; }
        .doc-list { list-style-type: disc; padding-left: 20px; margin-bottom: 10px; }
        .doc-list li { margin-bottom: 5px; font-size: 10.5pt; }
        .std-signature-line { border-top: 1px solid #000; width: 100%; margin-top: 40px; padding-top: 5px; font-size: 10pt; font-weight: bold; }

        /* --- DEBUGGED PRINT STYLES --- */
        @media print {
            /* 1. Page Setup */
            @page { 
                size: auto; 
                margin: 0; 
            }

            /* 2. Global Resets to override Dashboard Layout */
            body, html {
                height: auto !important;
                width: 100% !important;
                overflow: visible !important;
                background-color: white !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            /* 3. Hide EVERYTHING by default */
            body > * {
                display: none !important;
            }

            /* 4. Hide Specific UI Elements explicitly just in case */
            header, 
            .w-64, /* Sidebar */
            .w-96, /* Input Panel */
            .no-print,
            button {
                display: none !important;
            }

            /* 5. Target the Main Content Wrapper */
            /* We unlock the flex containers that hold the preview */
            .flex, .flex-1, .h-screen, .overflow-hidden, .overflow-y-auto {
                display: block !important;
                height: auto !important;
                overflow: visible !important;
                position: static !important;
            }

            /* 6. Isolate and Position the Preview Pane */
            /* We show the parents of the preview pane, but strip their styling */
            div:has(> #previewContainer), 
            #previewContainer {
                display: block !important;
                position: absolute !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
            }

            #docPreview {
                display: block !important;
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 20mm !important; /* Set standard print margins here */
                box-shadow: none !important;
                border: none !important;
                height: auto !important;
                overflow: visible !important;
                min-height: 0 !important;
            }

            /* 7. Document Styling Fixes for Print */
            .placeholder-data {
                border: none !important; /* Remove dashed lines on print */
                background-color: transparent !important;
                padding: 0 !important;
            }
            
            /* 8. Page Breaks */
            .break-before-page { page-break-before: always; }
            .break-inside-avoid { page-break-inside: avoid; }
            h1, h2, h3, h4 { page-break-after: avoid; }
            img { max-width: 100% !important; }
            
            /* 9. Color Accuracy */
            * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body class="flex flex-col h-screen">

    <header class="bg-leaso-dark text-white h-16 flex items-center justify-between px-6 border-b-4 border-leaso-gold z-50 shadow-md no-print">
        <div class="flex items-center gap-3">
            <a href="index.html" class="text-gray-400 hover:text-white transition"><i class="fas fa-th text-xl"></i></a>
            <div class="h-6 w-px bg-gray-600"></div>
            <h1 class="font-serif text-lg font-bold tracking-wide">FORMER OS <span class="text-leaso-gold text-xs font-sans font-normal uppercase ml-2">Document Engine</span></h1>
        </div>
        <div class="flex items-center gap-3">
            <button onclick="printDocument()" class="bg-leaso-gold hover:bg-yellow-600 text-white px-4 py-2 rounded text-xs font-bold uppercase tracking-wider shadow transition">
                <i class="fas fa-print mr-2"></i> Print / Save PDF
            </button>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        
        <div class="w-64 bg-white border-r border-gray-200 flex flex-col p-4 z-40 shadow-sm no-print">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4">Templates</h3>
            <div class="space-y-1">
                <button onclick="loadTemplate('vendor')" class="doc-nav-btn w-full active" id="btn-vendor"><i class="fas fa-tools w-6 text-center"></i> Vendor Agreement</button>
                <button onclick="loadTemplate('contractor')" class="doc-nav-btn w-full" id="btn-contractor"><i class="fas fa-file-contract w-6 text-center"></i> Contractor Svc.</button>
                <button onclick="loadTemplate('occupancy')" class="doc-nav-btn w-full" id="btn-occupancy"><i class="fas fa-bed w-6 text-center"></i> Short Term Stay</button>
                <button onclick="loadTemplate('notice')" class="doc-nav-btn w-full" id="btn-notice"><i class="fas fa-door-open w-6 text-center"></i> Notice of Entry</button>
            </div>
        </div>

        <div class="w-96 bg-gray-50 border-r border-gray-200 overflow-y-auto p-6 shadow-inner z-30 no-print">
            <h3 class="text-sm font-bold text-leaso-blue uppercase tracking-wide mb-6 border-b border-gray-200 pb-2">Document Data</h3>
            <div id="formContainer" class="space-y-4">
                </div>
        </div>

        <div class="flex-1 bg-gray-200 overflow-y-auto p-8 flex justify-center relative">
            <div id="previewContainer">
                <div id="docPreview" class="preview-pane relative">
                    </div>
            </div>
        </div>

    </div>

    <script>
        let currentTemplate = 'vendor';
        const today = new Date().toISOString().split('T')[0];
        const LEASO_LOGO = "https://img1.wsimg.com/isteam/ip/0bfec085-3f40-401f-834e-86515cf3fc7f/Leaso-799e647.png/:/rs=w:535,h:227,cg:true,m/cr=w:535,h:227/qt=q:100/ll";

        // --- DATA OBJECTS ---
        const TEMPLATES = {
            vendor: {
                title: "Vendor Services Agreement",
                inputs: [
                    { id: 'v_legal_name', label: 'Vendor Legal Name', type: 'text' },
                    { id: 'v_dba', label: 'Doing Business As (DBA)', type: 'text' },
                    { id: 'v_address', label: 'Primary Office Address', type: 'text' },
                    { id: 'v_contact', label: 'Primary Contact Person', type: 'text' },
                    { id: 'v_phone', label: '24/7 Dispatch Phone', type: 'text' },
                    { id: 'v_email', label: 'Invoicing Email', type: 'text' },
                    { id: 'v_logo', label: 'Vendor Logo URL', type: 'text', placeholder: 'https://...' },
                    { id: 'v_date', label: 'Effective Date', type: 'date', value: today }
                ],
                render: (data) => `
                    <div class="v-header">
                        <div class="v-logo-container">
                            <div class="v-logo-box">
                                <img src="${LEASO_LOGO}" alt="Leaso Logo">
                            </div>
                            <div class="v-logo-box">
                                ${data.v_logo ? `<img src="${data.v_logo}" alt="Vendor Logo">` : ''}
                            </div>
                        </div>
                        <h1 class="v-h1">Master Vendor Services Agreement</h1>
                        <p class="v-jurisdiction">PROVINCE OF ONTARIO | PREMIUM CONTRACTOR CLASS</p>
                    </div>

                    <p><strong>THIS AGREEMENT</strong> is made effective as of <span class="placeholder-data">${formatDate(data.v_date)}</span> (the "Effective Date"),</p>
                    
                    <p><strong>BETWEEN:</strong></p>
                    <p><strong>Leaso</strong> (and its affiliates)<br>
                    (Hereinafter referred to as the "Corporation" or "Manager")</p>
                    
                    <p><strong>AND:</strong></p>
                    <p><span class="placeholder-data">${data.v_legal_name || '____________________'}</span> operating as <span class="placeholder-data">${data.v_dba || '____________________'}</span><br>
                    (Hereinafter referred to as the "Vendor" or "Contractor")</p>

                    <div class="custom-section-box" style="background-color: var(--legal-bg); border-left-color: var(--vendor-primary);">
                        <p><strong>RECITALS:</strong><br>
                        WHEREAS Leaso manages residential and commercial assets within the Province of Ontario; and<br>
                        WHEREAS the Vendor represents itself as a qualified, insured, and WSIB-compliant entity capable of performing the Services;<br>
                        NOW THEREFORE, in consideration of the mutual covenants contained herein, the Parties agree as follows:</p>
                    </div>

                    <h2 class="v-h2">SECTION I: REGULATORY COMPLIANCE & IDENTITY</h2>
                    <p>The Vendor acknowledges that compliance with Ontario laws is a material condition of this Agreement. The Vendor agrees to maintain the following verified information:</p>
                    
                    <div class="compliance-grid">
                        <div class="compliance-item"><strong>Legal Entity / Business Name</strong> <span class="placeholder-data">${data.v_legal_name || '___'}</span></div>
                        <div class="compliance-item"><strong>CRA Business Number (HST)</strong> <span>_________________ RT____</span></div>
                        <div class="compliance-item"><strong>Primary Office Address</strong> <span class="placeholder-data">${data.v_address || '___'}</span></div>
                        <div class="compliance-item"><strong>WSIB Account Number</strong> <span>_________________________</span></div>
                        <div class="compliance-item"><strong>Primary Contact Person</strong> <span class="placeholder-data">${data.v_contact || '___'}</span></div>
                        <div class="compliance-item"><strong>24/7 Dispatch Phone</strong> <span class="placeholder-data">${data.v_phone || '___'}</span></div>
                        <div class="compliance-item"><strong>Invoicing/Admin Email</strong> <span class="placeholder-data">${data.v_email || '___'}</span></div>
                        <div class="compliance-item"><strong>ESA/TSSA License (If Applicable)</strong> <span>_________________________</span></div>
                    </div>

                    <h3 class="v-h3">1.1. Workplace Safety & Insurance Board (WSIB)</h3>
                    <p>The Vendor must maintain Good Standing with the WSIB. An <strong>eClearance Certificate</strong> must be available to Leaso upon request. Exception: Independent Operators (IO) must provide a valid WSIB "Independent Operator Status Ruling".</p>

                    <h3 class="v-h3">1.2. Insurance Requirements</h3>
                    <p>Vendor shall maintain Commercial General Liability (CGL) insurance with a limit of not less than <strong>$2,000,000 CAD</strong> per occurrence. The policy must include "Leaso" as an <strong>Additional Insured</strong>.</p>

                    <h2 class="v-h2">SECTION II: SERVICES, RATES & CONDITIONS</h2>
                    <div class="custom-section-box">
                        <h4 style="margin-top:0; color:var(--vendor-primary); font-weight:700;">SERVICE PARAMETERS</h4>
                        <div class="input-grid">
                            <div><span class="input-label">Primary Trade</span><div class="input-field">e.g., HVAC, Plumbing</div></div>
                            <div><span class="input-label">Standard Hourly Rate</span><div class="input-field">$ ___________ / Hour</div></div>
                            <div><span class="input-label">Emergency Rate</span><div class="input-field">$ ___________ / Hour</div></div>
                            <div><span class="input-label">Diagnostic / Trip Charge</span><div class="input-field">$ ___________ Flat Fee</div></div>
                            <div><span class="input-label">Pre-Approval Limit (NTE)</span><div class="input-field">$ 400.00 (Default)</div></div>
                            <div><span class="input-label">Service Radius</span><div class="input-field">Greater Toronto Area (GTA)</div></div>
                        </div>
                    </div>

                    <h2 class="v-h2">SECTION III: OPERATIONAL EXECUTION</h2>
                    <h3 class="v-h3">3.1. RTA Compliance</h3>
                    <p>Vendor agrees strictly <strong>NOT to enter</strong> a rental unit unless proper Notice of Entry is confirmed, explicit consent is given, or it is a bona fide emergency.</p>
                    <h3 class="v-h3">3.2. OHSA</h3>
                    <p>Vendor assumes all responsibility as a "Constructor" or "Employer" under the <em>OHSA</em> for their own staff.</p>
                    <h3 class="v-h3">3.3. Tenant Interactions</h3>
                    <p>Vendor shall not discuss the cost of repairs, lease terms, or owner details with Tenants.</p>

                    <h2 class="v-h2">SECTION IV: SPECIAL TERMS</h2>
                    <div class="custom-section-box" style="border-left: 4px solid var(--vendor-primary); min-height:80px;">
                        <p><em>[Insert custom negotiated terms here. E.g., Payment terms Net 15, Specific material markups, etc.]</em></p>
                    </div>

                    <h2 class="v-h2">SECTION V: INDEMNIFICATION</h2>
                    <p><strong>VENDOR AGREES TO INDEMNIFY</strong> and hold harmless Leaso and Property Owners from any liability arising from the Vendor’s negligence or breach.</p>

                    <div class="signature-section">
                        <div>
                            <h4>AGREED BY VENDOR:</h4>
                            <p style="font-size: 9pt;">I have authority to bind the Corporation.</p>
                            <div class="sig-line"></div>
                            <p class="placeholder-data" style="border:none; padding:0;">${data.v_contact || 'Authorized Signatory'}</p>
                            <br><p>Date: ________________________</p>
                        </div>
                        <div>
                            <h4>ACCEPTED BY LEASO:</h4>
                            <p style="font-size: 9pt;">Leaso (Property Management)</p>
                            <div class="sig-line"></div>
                            <p>Authorized Representative</p>
                            <br><p>Date: ________________________</p>
                        </div>
                    </div>

                    <div class="break-before-page">
                        <div class="v-header"><h1>ADDENDUM A: NETWORK ACCESS & BILLING</h1></div>
                        <p><strong>SUBJECT:</strong> Preferred Vendor Network Margin & Payment Processing</p>
                        <h3 class="v-h3">1. Engagement Network Margin</h3>
                        <p>Vendor agrees to a <strong>Preferred Network Margin of 10%</strong> deducted from the total pre-tax invoice amount to support administrative infrastructure.</p>
                        <h3 class="v-h3">2. Construction Act Holdbacks</h3>
                        <p>For projects >$25,000 CAD, Leaso reserves the right to retain a <strong>10% Statutory Holdback</strong>.</p>
                        <h3 class="v-h3">3. Confidentiality</h3>
                        <p>The terms of this commercial arrangement are strictly confidential.</p>
                        <div class="signature-section">
                            <div><div class="sig-line"></div><p><strong>Vendor Initials</strong></p></div>
                            <div><div class="sig-line"></div><p><strong>Leaso Initials</strong></p></div>
                        </div>
                    </div>
                    <div class="legal-footer">VENDEX 1.0 GENERATED DOCUMENT | JURISDICTION: ONTARIO | FORM ID: LEASO-ONT-2025-A</div>
                `
            },
            contractor: {
                title: "Contractor Agreement",
                inputs: [
                    { id: 'c_name', label: 'Contractor Name', type: 'text' },
                    { id: 'c_role', label: 'Role / Title', type: 'text', placeholder: 'e.g. Property Management Agent' },
                    { id: 'c_loc', label: 'Location', type: 'text', placeholder: 'e.g. Sault Ste. Marie' },
                    { id: 'c_start', label: 'Start Date', type: 'date', value: today },
                    { id: 'c_rate', label: 'Hourly Rate (CAD)', type: 'number', value: '12' }
                ],
                render: (data) => `
                    <div class="doc-header flex justify-between items-center">
                        <img src="${LEASO_LOGO}" style="height:50px;">
                        <div>
                            <h1 class="font-serif font-bold text-xl text-leaso-blue text-right">SERVICE AGREEMENT</h1>
                            <p class="text-[10px] text-gray-500 text-right uppercase">Provision of Property Management Services</p>
                        </div>
                    </div>

                    <div class="doc-section mt-6">
                        <p class="doc-p"><strong>1. Details of the Parties</strong><br>
                        This agreement is made between:<br>
                        <strong>[Leaso Property Management: 2-558 Upper Gage Ave Suite 316, Hamilton ON L8V 4J6]</strong> ("the Client")<br>
                        and<br>
                        <strong>${data.c_name || '___'}</strong> as ${data.c_role || 'Contractor'} in ${data.c_loc || '___'} ("the Contractor")</p>
                    </div>

                    <h2 class="doc-h2">2. Background</h2>
                    <p class="doc-p">A. The Client is of the opinion that the Contractor has the necessary qualifications, experience, and abilities to provide services to the Client.</p>
                    <p class="doc-p">B. The Contractor is agreeable to providing such services to the Client on the terms and conditions set out in this Agreement</p>

                    <h2 class="doc-h2">3. Commencement and Termination</h2>
                    <p class="doc-p">This Agreement commenced on <u>${formatDate(data.c_start)}</u> and shall continue until terminated by either party. Either party may terminate this agreement by written notice to the other party.</p>

                    <h2 class="doc-h2">4. Services</h2>
                    <p class="doc-p">Leaso Property Management engages the Contractor to provide, and the Contractor agrees to provide, Property Management services within the scope of his professional competence and fully in line with the terms and conditions set out in this Agreement.</p>
                    <p class="doc-p">The work will be carried out by the named Contractor appointed, who may not sub-contract all or any part of the work to someone else, without the written agreement of the Client.</p>
                    <p class="doc-p">The Services to be provided by the Contractor under this Agreement include but are not limited to:</p>
                    <ul class="doc-list">
                        <li>Review and assess rental applications for completeness and suitability.</li>
                        <li>List and track vacant rental units, ensuring timely marketing.</li>
                        <li>Respond promptly to tenant inquiries and coordinate maintenance requests.</li>
                        <li>Manage rent collection and utility payment tracking.</li>
                        <li>Coordinate with contractors and service providers as necessary.</li>
                        <li>Prepare and send notices in accordance with Landlord and Tenant Board (LTB) guidelines.</li>
                        <li>Draft and distribute tenant communication with professionalism.</li>
                        <li>Provide administrative support including document management and organization.</li>
                    </ul>

                    <h2 class="doc-h2">5. Terms</h2>
                    <p class="doc-p">The Contractor is an independent contractor and is not an employee of Leaso Property Management. In this context, the Contractor shall be wholly responsible for all local income tax and other similar contributions or taxes (together “Taxes”) which may be payable out of, or as a result of the receipt of, any fees or other monies paid or payable by the Client under this Agreement.</p>
                    <p class="doc-p">The Contractor cannot incur any liabilities or obligations, express or implied, on behalf of the Client unless specifically authorized in writing to do so.</p>
                    <p class="doc-p">The Contractor is 24/7 on call for tenants' calls /emergencies.</p>

                    <h2 class="doc-h2">6. Fees</h2>
                    <p class="doc-p">The Client will pay a fee of <strong>$${data.c_rate} CAD</strong> per hour for services under this Contract and shall be paid monthly on the 5th of each month. A contractor invoice needs to be submitted by the Contractor to the Client. The Client is not obliged to provide the Contractor with any other wages, salary, sickness pay, holiday allowance, or any other payments or benefits whatsoever.</p>

                    <h2 class="doc-h2">7. Confidentiality</h2>
                    <p class="doc-p">Confidential information refers to any data or information relating to the Client, whether business or personal, which would reasonably be considered to be private or proprietary to the Client and that is not generally known and where the release of that confidential information could reasonably be expected to cause harm to the Client.</p>
                    <p class="doc-p">In the event of Leaso Property Management making available confidential information relating to the business, clients, or customers in the course of this Agreement, the Contractor will maintain the confidentiality of such information, and will not disclose it to any third parties whatsoever. Furthermore, except in so far as such matters are properly in, or come into the public domain, the Contractor agrees to keep secret and confidential all matters contained in this Agreement.</p>

                    <h2 class="doc-h2">8. Ownership of Intellectual Property</h2>
                    <p class="doc-p">All intellectual property and related material, including any trade secrets, moral rights, goodwill, relevant registrations or applications for registration, rights in any patent, copyright, trademark, and trade name that is developed or produced under this Agreement, will be the sole property of the Client. The use of the Intellectual Property by the Client will not be restricted in any manner.</p>
                    <p class="doc-p">The Contractor may not use the Intellectual Property for any purpose other than that contracted for this Agreement except with the written consent of the Client. The Contractor will be responsible for any and all damages resulting from the unauthorized use of the Intellectual Property.</p>

                    <h2 class="doc-h2">9. Indemnification</h2>
                    <p class="doc-p">The Contractor will hold harmless and indemnify the Client against any and all claims and actions arising out of the participation of the Client in the Activity, including, without limitation, Expenses, judgments, fines, settlements, and other amounts actually and reasonably incurred in connection with any liability, suit, action, loss, or damage arising or resulting from the Client's participation in the Activity, subject to the limits on indemnification described in the section titled Exceptions to Indemnification. Where prohibited by law, the above indemnification does not include indemnification of the Client against a claim caused by the negligence or fault of the Client, its agent or employee, or any third party under the control or supervision of the Client, other than the Contractor or its agent, employee or subcontractors.</p>

                    <h2 class="doc-h2">10. Provision of Workspace, Equipment, and Materials</h2>
                    <p class="doc-p">The Contractor will undertake the Services substantially at their own premises and using their own equipment and materials, the costs of which shall be deemed to have been included within the fee indicated herein. The Contractor will, upon the termination of their engagement, immediately deliver to the Client all correspondence, documents, and property belonging to the Client that may be in their possession or under their control. Any materials whether physical, electronic or intellectual created by the Contractor in the course of carrying out Services under this Agreement will belong to the Client which shall retain the exclusive rights to such material unless agreed otherwise in writing by the Client.</p>

                    <h2 class="doc-h2">11. Force Majeure</h2>
                    <p class="doc-p">Neither party shall be deemed in default of its obligations under this agreement nor shall be liable to the other to the extent that it is unable to perform any of its obligations by reason of any event or circumstance beyond its reasonable control.</p>

                    <div class="mt-12 break-inside-avoid">
                        <h2 class="doc-h2">12. Signatures</h2>
                        <div class="flex justify-between gap-12 mt-8">
                            <div class="w-1/2">
                                <p class="text-sm font-bold">Client: LEASO PROPERTY MANAGEMENT</p>
                                <div class="std-signature-line">Signature</div>
                                <p class="text-xs mt-1">Date: ${formatDate(today)}</p>
                            </div>
                            <div class="w-1/2">
                                <p class="text-sm font-bold">Contractor: ${data.c_name}</p>
                                <div class="std-signature-line">Signature</div>
                                <p class="text-xs mt-1">Date:</p>
                            </div>
                        </div>
                    </div>
                `
            },
            occupancy: {
                title: "Short Term Occupancy",
                inputs: [
                    { id: 'o_occupant', label: 'Occupant Name', type: 'text' },
                    { id: 'o_addr', label: 'Address', type: 'text' },
                    { id: 'o_phone', label: 'Phone', type: 'text' },
                    { id: 'o_email', label: 'Email', type: 'text' },
                    { id: 'o_car', label: 'Vehicle Make/Model', type: 'text' },
                    { id: 'o_plate', label: 'License Plate', type: 'text' },
                    { id: 'o_dl', label: 'DL Number', type: 'text' },
                    { id: 'o_emerg', label: 'Emergency Contact', type: 'text' },
                    { id: 'o_emerg_ph', label: 'Emerg. Phone', type: 'text' },
                    { id: 'o_unit', label: 'Suite Location', type: 'text' },
                    { id: 'o_in', label: 'Check In', type: 'date' },
                    { id: 'o_out', label: 'Check Out', type: 'date' }
                ],
                render: (data) => `
                    <div class="text-center mb-6">
                        <img src="${LEASO_LOGO}" style="height:60px; margin: 0 auto 10px;">
                        <h1 class="font-bold text-lg">LEASO SHORT TERM RENTALS</h1>
                        <p class="text-xs">2-558 Upper Gage Ave suite 316, Hamilton ON, L8V4J6</p>
                        <p class="text-xs">www.leaso.ca | management@leaso.ca | 1-289-769-8764</p>
                    </div>
                    
                    <h1 class="doc-title text-center text-xl mb-6 border-b-2 border-leaso-gold pb-4">TEMPORARY OCCUPANCY AGREEMENT</h1>
                    
                    <p class="doc-p">This Agreement is entered into between <strong>2827893 Ontario Inc</strong> (the “Owner”) and <strong>${data.o_occupant || '______________________'}</strong> (the “Occupant”)</p>

                    <div class="doc-section bg-gray-50 p-4 border border-gray-200 rounded text-sm space-y-2">
                        <p class="font-bold border-b pb-1 mb-2">OCCUPANT -</p>
                        <div class="grid grid-cols-1 gap-2">
                            <div>NAME: ${data.o_occupant || '______________________________________________________'}</div>
                            <div>ADDRESS: ${data.o_addr || '___________________________________________________'}</div>
                            <div>PHONE: ${data.o_phone || '______________________________________________________'}</div>
                            <div>EMAIL: ${data.o_email || '______________________________________________________'}</div>
                            <div>VEHICLE MAKE/MODEL: ${data.o_car || '______________________________________'}</div>
                            <div>LICENSE PLATE: ${data.o_plate || '______________________________________________'}</div>
                            <div>DRIVER’S LICENSE NUMBER: ${data.o_dl || '__________________________________'} (Must provide copy)</div>
                            <div>EMERGENCY CONTACT: ${data.o_emerg || '_______________________________________'}</div>
                            <div>EMERG CONTACT PHONE: ${data.o_emerg_ph || '_____________________________________'}</div>
                        </div>
                    </div>

                    <h2 class="doc-h2">Occupant agrees as follows:</h2>
                    <ol class="list-decimal pl-5 text-sm space-y-2">
                        <li>This Agreement may be subject to all or part of the Ontario Innkeepers Act, Occupiers Liability Act, Negligence Act, all R.S.O 1990, and other applicable Laws, Bylaws and Regulations in force during this Agreement.</li>
                        <li>The Owner offers the Occupant use of the Suite located at <strong>${data.o_unit || '___________________________________________________'}</strong></li>
                        <li>The Occupancy Period begins with check in at 11:00AM on <strong>${formatDate(data.o_in)}</strong> and check out at 11:00 am on <strong>${formatDate(data.o_out)}</strong>. Subject to availability, the Occupancy Period may be extended on 30 days’ written notice to the Owner and receipt of his consent to such extension.</li>
                        <li>On signing, the Occupant agrees to provide, by e-transfer, cash, bank draft or credit card:
                            <ul class="list-disc pl-5 mt-1">
                                <li>The sum of $1,350 CDN) as first months fees for the Occupancy Period</li>
                                <li>The sum of $1,350 (CDN) as last months fees for the Occupancy Period.</li>
                                <li>The sum of $500 (CDN) for the refundable deposits.</li>
                                <li>The monthly Occupancy Fee is $1,350 (CDN) paid every first of the month.</li>
                            </ul>
                        </li>
                    </ol>
                    <p class="doc-p mt-4 italic text-sm">*The OCCUPANT is required to transfer all utility services into his name and accept responsibility for monthly billing charges. It also includes the lawn care and snow removal services. (__________).</p>
                    <p class="doc-p text-sm">Completed Credit Card Authorization Form for additional costs incurred by the Owner for example cleaning.</p>

                    <div class="doc-section mt-4 bg-gray-100 p-2 rounded">
                        <p class="font-bold text-xs">NOTE:</p>
                        <ul class="text-xs list-disc pl-4">
                            <li>First and Last months deposits are non-refundable.</li>
                            <li>Payment needs to be processed via Tenant Portal.</li>
                            <li>Credit cards are subject to a 3.5% fee.</li>
                            <li>$100 charge for each NSF cheque.</li>
                            <li>2.5% of rent is charge for late payments.</li>
                            <li>All monthly payments are due on the 1st of every month.</li>
                            <li>2%/month interest will be applied to all outstanding invoices.</li>
                        </ul>
                    </div>

                    <h2 class="doc-h2">TERMS AND CONDITIONS</h2>
                    <ul class="doc-list text-sm">
                        <li>The Suite can only be occupied by the Occupant as outlined on the previous page.</li>
                        <li>The Occupant shall not assign, sublet or allow any other person(s) to occupy the Suite without the written consent of the Owner. Any person occupying the Suite under an assignment or sublet, will be provided with a copy of this Agreement and will be bound by its terms;</li>
                        <li>The Occupant will be provided with 2 keys to the Suite. <strong>KEYS CANNOT BE DUPLICATED WITHOUT THE CONSENT OF THE OWNER. (__________).</strong></li>
                        <li>The Owner, or his agent, reserves the right to enter the Suite to conduct an inspection and/or make repairs, at reasonable times and with prior notice when possible. If an inspection reveals the Suite is not being maintained in accordance with this Agreement, the Suite will be professionally cleaned at the Occupant’s cost; (__________).</li>
                        <li>The Occupant is liable under this Agreement and will indemnify the Owner for any costs or damages arising from the Occupant or their guests’ actions or omissions during the term of this Agreement.</li>
                        <li>An Inventory List is kept in each Suite. Unless advised that something is missing by the Occupant, the Inventory List will govern. The Occupant will be charged for any damage or alterations (including moved or missing furniture or artwork) to the Suite.</li>
                        <li>The Occupant shall comply with all building, zoning, health codes and other applicable laws/bylaws of the Province of Ontario and City of Hamilton. Occupant agrees not to use any type of plug in room fresheners. All garbage to be disposed of and recycling to to be recycled and put into respective containers provided, – all cardboard to be flattened. Smoke/ carbon monoxide detectors are not to be disconnected or tampered with. Any issues or concerns must be reported immediately to management@leaso.ca (please initial your understanding of (________).</li>
                        <li><strong>SMOKING IS PROHIBITED,</strong> there is a charge of $500 for any infractions. Please initial your understanding of (_________).</li>
                        <li><strong>NO PETS ARE ALLOWED IN THE SUITE UNDER ANY CIRCUMSTANCES.</strong> Please initial your understanding of (_________).</li>
                        <li>The Occupant shall not conduct any activity deemed to be illegal, hazardous, or a nuisance, in the reasonable opinion of the Owner.</li>
                    </ul>

                    <h2 class="doc-h2">Default is:</h2>
                    <ul class="doc-list text-sm">
                        <li>Misrepresentation in our application form.</li>
                        <li>Failure to comply with any term of this Agreement.</li>
                        <li>Reasonable complaints from occupants of other suites or neighbors; and</li>
                        <li>Disparagement of the Owner, including any posts on the internet.</li>
                    </ul>
                    <p class="doc-p text-sm">In the event of default, the Owner can immediately terminate this Agreement and, without notice, re-enter and reclaim possession of the Suite, in addition to such other remedies available to the Owner at law. If the Occupant is in default, he/she will also be considered in default for any other Suite(s) occupied by him/her.</p>
                    <p class="doc-p text-sm">Failure of the Owner to exercise, or any delay by the Owner in exercising, any right or remedy provided under this Agreement is not a waiver of the Owner’s right or remedy, nor will it preclude or restrict any further exercise of that right or any other right or remedy. Any costs incurred by the Owner as a result of default will be charged to the Occupant’s credit card.</p>
                    <p class="doc-p text-sm">No over-holding will be tolerated by the Owner. If the Occupant does not provide vacant possession at the end of the Occupancy Period, the Owner can immediately enter the Suite to reclaim possession, any personal items left behind will be put into storage, at the Occupant’s expense.</p>
                    <p class="doc-p text-sm">All keys/remotes will be returned by the Occupant at the end of the Occupancy Period. Failure to do so will result in a $100.00 charge/key/remote.</p>
                    <p class="doc-p text-sm">This Agreement must be returned to the Owner before possession is taken. If the Agreement is not signed or returned on possession, the Occupant agrees this Agreement shall govern and he/she shall be subject to its terms.</p>
                    <p class="doc-p text-sm">The occupant agrees to be responsible for the full amount of the occupancy fee for the entire duration of this agreement. In the event the Occupant chooses to vacate the unit prior to the agreement’s expiration, they shall remain liable for payments until the unit is reassign or until the original term of agreement concludes. ( ________)</p>
                    <p class="doc-p text-sm">In the event of the owner's decision to sell the property, the owner reserves the right to terminate this temporary agreement by providing the tenant with a 30-day notice. The tenant agrees to vacate the premises by the specified date and return possession of the property to the owner.( _________)</p>

                    <div class="mt-8 break-inside-avoid">
                        <p class="text-center font-bold text-sm mb-4">SIGNATURE PAGE FOLLOWS</p>
                        <p class="text-sm italic mb-6">I, ____________________________(OCCUPANT) have read and understood the terms of this Agreement and agree to abide by it during my Occupancy Period. I further acknowledge that I have received a copy of this Agreement.</p>
                        
                        <div class="flex justify-between gap-12 mb-8">
                            <div class="w-1/2">
                                <div class="std-signature-line">TUK Developments Inc (A.S.O)</div>
                                <p class="text-xs mt-1">Date: ______________________</p>
                            </div>
                            <div class="w-1/2">
                                <div class="std-signature-line">Occupant</div>
                                <p class="text-xs mt-1">Date: ______________________</p>
                            </div>
                        </div>
                    </div>

                    <div class="break-before-page mt-8 pt-8">
                        <div class="text-center mb-6">
                            <img src="${LEASO_LOGO}" style="height:50px; margin: 0 auto 10px;">
                            <p class="font-bold text-xs">LEASO SHORT TERM RENTALS</p>
                            <p class="text-xs">2-558 Upper Gage Ave suite 316, Hamilton ON, L8V4J6</p>
                            <p class="text-xs">www.leaso.ca | management@leaso.ca | 1-289-769-8764</p>
                        </div>

                        <p class="font-bold mb-4">Credit card information is required.</p>
                        <p class="text-sm">Location: ____________________________________</p>
                        <p class="text-sm">Start Date: _________________________</p>

                        <h3 class="font-bold text-md mt-6 mb-2">Credit Card Authorization Form</h3>
                        <p class="text-sm mb-4">Credit Card Type: VISA ____ Mastercard ____ AMEX _____<br>
                        Account type: Personal _______ Business _______<br>
                        Company Name:___________________________</p>

                        <h3 class="font-bold text-md mb-2">Credit Card Information</h3>
                        <div class="text-sm space-y-2 mb-6">
                            <p>Name On Credit Card: __________________________</p>
                            <p>Card Number: _______________</p>
                            <p>Expiration date:______________ CVV:_________</p>
                            <p>Billing address:<br>
                            City:________________ Province:_____________ Postal Code:_____________</p>
                            <p>Phone:______________  Email:_______________________</p>
                        </div>

                        <h3 class="font-bold text-md mb-2">Authorized User of Credit Card Information</h3>
                        <div class="text-sm bg-gray-50 p-2 border rounded mb-4">
                            <p>Name: 2827893 Ontario Inc.</p>
                            <p>Company: Leaso Property Management</p>
                            <p>Telephone number: 1-289-769-8764</p>
                            <p>Email address: management@leaso.ca</p>
                        </div>

                        <p class="text-sm italic mb-2">Type of charges to credit card on file would be to replace security deposit and only to be used in the event of missed monthly rent and/or for any damages to the <strong>PREMISES</strong>, in excess of normal wear and tear.</p>
                        <p class="text-sm italic mb-6">Credit card may also be used at the request of cardholder to pay monthly fees. A 3.5% service charge applies for Visa/MC and 3.5% for AMEX</p>

                        <h3 class="font-bold text-md mb-2">AUTHORIZATION OF CARD USE</h3>
                        <p class="text-sm mb-8">I hereby authorize collection of payment for charges as indicated above.</p>
                        
                        <div class="w-1/2">
                            <div class="std-signature-line">Signature of Cardholder</div>
                            <p class="text-sm mt-2">Name: ___________________________________________________</p>
                            <p class="text-sm">Date:_____________________</p>
                        </div>
                    </div>
                `
            },
            notice: {
                title: "Notice of Entry (N5/N7)",
                inputs: [
                    { id: 'n_tenant', label: 'Tenant Name', type: 'text' },
                    { id: 'n_addr', label: 'Unit Address', type: 'text' },
                    { id: 'n_date', label: 'Entry Date', type: 'date', value: today },
                    { id: 'n_time', label: 'Entry Time', type: 'text', value: 'Between 9:00 AM and 5:00 PM' },
                    { id: 'n_reason', label: 'Reason', type: 'text', value: 'Essential Maintenance / Inspection' },
                    { id: 'n_context', label: 'Legal Context', type: 'select', options: ['Standard', 'N5 (Interference/Damage)', 'N7 (Impaired Safety)'] }
                ],
                render: (data) => `
                    <div class="doc-header flex justify-between items-start">
                        <div>
                            <h1 class="doc-title">NOTICE OF INTENT TO ENTER</h1>
                            <p class="doc-subtitle">Pursuant to s.27 Residential Tenancies Act, 2006</p>
                        </div>
                        <img src="${LEASO_LOGO}" style="height:60px;">
                    </div>

                    <div class="bg-gray-100 p-4 rounded mb-6 border border-gray-200">
                        <p><strong>TO:</strong> ${data.n_tenant || 'All Occupants'}</p>
                        <p><strong>RENTAL UNIT:</strong> ${data.n_addr || '___'}</p>
                        <p><strong>DATE:</strong> ${formatDate(today)}</p>
                    </div>

                    <p class="doc-p">Please be advised that the Landlord (or authorized agent) will be entering your rental unit in accordance with the RTA.</p>

                    <table class="w-full text-left border-collapse mt-4 mb-6">
                        <tr><td class="py-2 border-b w-1/3 font-bold">REASON:</td><td class="py-2 border-b">${data.n_reason}</td></tr>
                        <tr><td class="py-2 border-b font-bold">DATE OF ENTRY:</td><td class="py-2 border-b">${formatDate(data.n_date)}</td></tr>
                        <tr><td class="py-2 border-b font-bold">TIME OF ENTRY:</td><td class="py-2 border-b">${data.n_time}</td></tr>
                    </table>

                    <p class="doc-p italic text-sm">As per the RTA, your presence is not required. The representative will enter using the master key if you are not home.</p>

                    ${(data.n_context === 'N5 (Interference/Damage)' || data.n_context === 'N7 (Impaired Safety)') ? `
                        <div class="mt-8 border-4 border-red-600 bg-white p-6">
                            <h3 class="text-red-700 font-bold text-lg uppercase mb-2 text-center"><i class="fas fa-exclamation-triangle mr-2"></i> CRITICAL: MANDATORY PREPARATION & LEGAL NOTICE</h3>
                            
                            <p class="doc-p text-sm font-bold">This treatment/inspection is required to break the pest lifecycle/maintain safety.</p>
                            
                            <p class="doc-p text-sm">The vendor has explicitly stated that failure to properly prepare your unit voids the warranty for the entire building. If your unit is not prepared for this scheduled visit, or if entry is refused, you will be held financially liable for the loss of the building warranty. This constitutes "Substantial Interference" with the Landlord's lawful rights and the reasonable enjoyment of other tenants.</p>

                            <div class="bg-red-50 p-4 mt-4 border-l-4 border-red-600">
                                <p class="font-bold text-red-800 uppercase text-xs mb-1">NOTICE REGARDING ATTACHED FORM ${data.n_context.split(' ')[0]}</p>
                                <p class="text-sm text-red-900">
                                    Due to the severity of the risk posed to the property and other residents by potential non-compliance, please find attached <strong>Form ${data.n_context.split(' ')[0]}</strong>: Notice to End your Tenancy for Interfering with Others, Damage or Overcrowding.
                                    <br><br>
                                    We strongly prefer to resolve this matter by simply completing the treatment successfully. However, we must protect the asset and the other residents. Ensure your unit is fully prepared according to the vendor's instructions to avoid further escalation to the Landlord and Tenant Board (LTB).
                                </p>
                            </div>
                        </div>
                        <div class="mt-6">
                            <p class="font-bold">Governed by,</p>
                            <p class="doc-p font-bold text-leaso-blue mt-2">LEASO PROPERTY MANAGEMENT</p>
                            <p class="text-xs uppercase text-gray-500">Authorized Agent for the Landlord</p>
                        </div>
                    ` : `
                        <div class="mt-12">
                            <p class="font-bold">Governed by,</p>
                            <p class="doc-p font-bold text-leaso-blue mt-2">LEASO PROPERTY MANAGEMENT</p>
                            <p class="text-xs uppercase text-gray-500">Authorized Agent for the Landlord</p>
                        </div>
                    `}
                `
            }
        };

        // --- FUNCTIONS ---
        function loadTemplate(key) {
            currentTemplate = key;
            document.querySelectorAll('.doc-nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${key}`).classList.add('active');

            const formContainer = document.getElementById('formContainer');
            formContainer.innerHTML = '';
            
            TEMPLATES[key].inputs.forEach(input => {
                const div = document.createElement('div');
                div.innerHTML = `<label class="block text-xs font-bold text-gray-500 uppercase">${input.label}</label>`;
                
                if (input.type === 'select') {
                    const sel = document.createElement('select');
                    sel.id = input.id;
                    sel.className = 'form-input bg-white';
                    sel.onchange = refreshPreview;
                    input.options.forEach(opt => {
                        const o = document.createElement('option');
                        o.value = opt;
                        o.text = opt;
                        sel.appendChild(o);
                    });
                    div.appendChild(sel);
                } else {
                    const inp = document.createElement('input');
                    inp.type = input.type;
                    inp.id = input.id;
                    inp.className = 'form-input';
                    if(input.placeholder) inp.placeholder = input.placeholder;
                    if(input.value) inp.value = input.value;
                    inp.oninput = refreshPreview;
                    div.appendChild(inp);
                }
                formContainer.appendChild(div);
            });
            refreshPreview();
        }

        function refreshPreview() {
            const tmpl = TEMPLATES[currentTemplate];
            const data = {};
            tmpl.inputs.forEach(i => data[i.id] = document.getElementById(i.id).value);
            document.getElementById('docPreview').innerHTML = tmpl.render(data);
        }

        function formatDate(d) {
            if(!d) return '_________';
            return new Date(d).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }

function printDocument() { 
    // 1. Store original title
    const originalTitle = document.title;
    
    // 2. Set title to document name (Browser uses this for PDF filename)
    document.title = TEMPLATES[currentTemplate].title + " - " + formatDate(today);
    
    // 3. Print
    window.print();
    
    // 4. Restore title after print dialog closes
    setTimeout(() => {
        document.title = originalTitle;
    }, 1000);
}

        window.onload = () => loadTemplate('vendor');
    </script>
</body>
</html>